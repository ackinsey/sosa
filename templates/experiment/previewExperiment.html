<!DOCTYPE html>
<html>
<head>
	<title>Preview Experiment</title>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script>

	$(document).ready(function(){

		$( "#launchExperimentBtn" ).click(function() {
			$( "#previewForm" ).submit();
			alert("form submited");
		});
		$( "#HideBoardBackgroundBtn" ).click(function() {
			alert("Background is hidden");
		});
		$( "#logOutputLocationBtn" ).click(function() {
			alert("choose output location here");
		});
		$( "#boardTiltBtn" ).click(function() {
			alert("set Tilt");
		});
		$( "#importSettingsBtn" ).click(function() {
			alert("Import here");
		});
		$( "#exportSettingsBtn" ).click(function() {
			alert("export here");
		});

	});


/***Default checkboxes and slider stuff**////
$(document).ready(function(){
	/******Changes The slider and the value count of the slider to its default value when the default checkbox is clicked*****/
	$(":checkbox").change(function(){
		if(this.checked){
			if ($(this).attr('name') == "defaultBoardCheckbox") {
				
				$("#RSliderBoard").val(255);
				$("#RSliderBoardOutput").val(255);
				$("#GSliderBoard").val(255);
				$("#GSliderBoardOutput").val(255);
				$("#BSliderBoard").val(255);
				$("BSliderBoardOutput").val(255);
			}
			else if($(this).attr('name') == "defaultBackgroundCheckbox"){
				$("#RSliderBackground").val(0);
				$("#RSliderBackgroundOutput").val(0);
				$("#GSliderBackground").val(0);
				$("#GSliderBackgroundOutput").val(0);
				$("#BSliderBackground").val(0);
				$("#BSliderBackgroundOutput").val(0);
			}
			else if($(this).attr('name') == "defaultLabelOutput"){
				$("#positionSLiderLabel").val(60);
				$("#positionSLiderOutput").val(60);
				$("#shadeSLiderLabel").val(100);
				$("#shadeSLiderOutput").val(100);
				$("#sizeSLiderLabel").val(75);
				$("#sizeSLiderOutput").val(75);

			}
		}
		else{
			if ($(this).attr('name') == "defaultBoardCheckbox") 
				checkIfDefault($("#RSliderBoard"), $("#GSliderBoard"), $("#BSliderBoard"), 255, 255, 255, $('#defaultBoardCheckbox'));
			else if($(this).attr('name') == "defaultBackgroundCheckbox")
				checkIfDefault($("#RSliderBackground"), $("#GSliderBackground"), $("#BSliderBackground"), 0, 0, 0, $('#defaultBackgroundCheckbox'));
			else if($(this).attr('name') == "defaultLabelOutput")
				checkIfDefault($("#positionSLiderLabel"), $("#shadeSLiderLabel"), $("#sizeSLiderLabel"), 60, 100, 75, $('#defaultLabelOutput'));
		}
	});
/********************************************************************************************************/

	/*****Changes the default checkbox to unchecked when atleast one of the three sliders in a group is changed 
	if all the sliders in the group are manually moved to the default the box rechecks itself *****/	
		$("#RSliderBoard").change(function(){
			$('#defaultBoardCheckbox').attr('checked', false);
			checkIfDefault($("#RSliderBoard"), $("#GSliderBoard"), $("#BSliderBoard"), 255, 255, 255, $('#defaultBoardCheckbox'));
		});
	$("#GSliderBoard").change(function(){
		$('#defaultBoardCheckbox').attr('checked', false);
		checkIfDefault($("#RSliderBoard"), $("#GSliderBoard"), $("#BSliderBoard"), 255, 255, 255, $('#defaultBoardCheckbox'));
	});
	$("#BSliderBoard").change(function(){
		$('#defaultBoardCheckbox').attr('checked', false);
		checkIfDefault($("#RSliderBoard"), $("#GSliderBoard"), $("#BSliderBoard"), 255, 255, 255, $('#defaultBoardCheckbox'));
	});

	$("#RSliderBackground").change(function(){
		$('#defaultBackgroundCheckbox').attr('checked', false);
		checkIfDefault($("#RSliderBackground"), $("#GSliderBackground"), $("#BSliderBackground"), 0, 0, 0, $('#defaultBackgroundCheckbox'));
	});
	$("#GSliderBackground").change(function(){
		$('#defaultBackgroundCheckbox').attr('checked', false);
		checkIfDefault($("#RSliderBackground"), $("#GSliderBackground"), $("#BSliderBackground"), 0, 0, 0, $('#defaultBackgroundCheckbox'));
	});
	$("#BSliderBackground").change(function(){
		$('#defaultBackgroundCheckbox').attr('checked', false);
		checkIfDefault($("#RSliderBackground"), $("#GSliderBackground"), $("#BSliderBackground"), 0, 0, 0, $('#defaultBackgroundCheckbox'));
	});

	$("#positionSLiderLabel").change(function(){
		$('#defaultLabelOutput').attr('checked', false);
		checkIfDefault($("#positionSLiderLabel"), $("#shadeSLiderLabel"), $("#sizeSLiderLabel"), 60, 100, 75, $('#defaultLabelOutput'));
	});
	$("#shadeSLiderLabel").change(function(){
		$('#defaultLabelOutput').attr('checked', false);
		checkIfDefault($("#positionSLiderLabel"), $("#shadeSLiderLabel"), $("#sizeSLiderLabel"), 60, 100, 75, $('#defaultLabelOutput'));
	});
	$("#sizeSLiderLabel").change(function(){
		$('#defaultLabelOutput').attr('checked', false);
		checkIfDefault($("#positionSLiderLabel"), $("#shadeSLiderLabel"), $("#sizeSLiderLabel"), 60, 100, 75, $('#defaultLabelOutput'));
	});


});
/*****************************************************************************************************************************/

/****Function to check wheter or not the sliders were manually moved to the default position, if so the corisponding 
default box is checked *****/
function checkIfDefault(slide1, slide2, slide3, value1, value2, value3, checkboxToCheck){
	if(slide1.val() == value1 && slide2.val() == value2 && slide3.val() == value3)
		checkboxToCheck.prop('checked', true)
}
/********************************************************************************************************************************/
</script>






</head>
<body>

	<div id="container" style="width:900px; height:800px;border:1px solid #000000;">
		
		<div id = "topHalf" style = "width:100%;height:50%;">

			<div id="presentationAndStimuli" style="width:25%;height:100%;float:left;">
				<span style = "width:100%;height:10%"><b>Presentation Order</b></span>
				<br>

				<select id = "presentationOrderSelect" style = "width:100%; height: 40%; float:left" multiple="multiple"/></select>
				<span style = "width:100%;height:10%"><b>Stimuli</b></span>

				<select id = "stimuli order Select" style = "width:100%; height: 45%; float:left"multiple="multiple"/></select>
			</div>

			<div id="canvas" style="width:75%;height:94.5%;float:left;">
				<canvas id = "PreviewCanvas"  style="border:1px solid #000000;height:100%; width:100%;"></canvas>
			</div>
		</div>
		<br>

		<div id="bottomHalf" style = "width:100%;height:50%;">
			
			<form id = "previewForm" method = "post">

				<div id="appearance" style="width:45%;float:left;">

					<fieldset>
						<legend>Appearance</legend>

						<table>
							<tr>
								
								<td align = "center" colspan = "2" style = "width:100%">
									Value
								</td>

								<td colspan = "2"align = "left"style="width:100%">
									Default
								</td>
							</tr>

							<tr>
								<td rowspan = "3">
									Board:
								</td>
								<td align = "left">
									R:<input type="range" id = "RSliderBoard" name = "RSliderBoard" min = "0" max = "255" value = 255 oninput="RSliderBoardOutput.value=RSliderBoard.value"> 
									<td>
										<output id="RSliderBoardOutput" name="RSliderBoardOutput" for="RSliderBoard">255</output>
									</td>
								</td>
								<td rowspan = "3" align = "left">
									<input type = "checkbox"  id = "defaultBoardCheckbox" name = "defaultBoardCheckbox" checked> 
								</td>
								
							</tr>
							<tr>
								<td align = "left">
									G:<input type="range" id = "GSliderBoard"name = "GSliderBoard" min = "0" max = "255" value = 255 oninput="GSliderBoardOutput.value=GSliderBoard.value"> 
									<td>
										<output id="GSliderBoardOutput" name="GSliderBoardOutput" for="GSliderBoard">255</output>
									</td>
								</td>

							</tr>
							<tr>
								<td align = "left">
									B:<input type="range" id = "BSliderBoard" name = "BSliderBoard" min = "0" max = "255" value = 255 oninput="BSliderBoardOutput.value=BSliderBoard.value">
									<td>
										<output id="BSliderBoardOutput" name="BSliderBoardOutput" for="BSliderBoard">255</output>
									</td>
								</td>

							</tr>




							<tr>
								<td rowspan = "3" align = "left" style ="width:15%"> Background&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
								<td align = "left">
									R:<input type="range" id = "RSliderBackground"name = "RSliderBackground" min = "0" max = "255" value = 0 oninput="RSliderBackgroundOutput.value=RSliderBackground.value"> 
									<td>
										<output id = "RSliderBackgroundOutput" name="RSliderBackgroundOutput" for="RSliderBackground">0</output>
									</td>
								</td>
								<td rowspan ="3" align = "left">
									<input type = "checkbox" id = "defaultBackgroundCheckbox" name = "defaultBackgroundCheckbox" checked>
								</td>
							</tr>
							<tr>
								<td align = "left">
									G:<input type="range" id = "GSliderBackground"name = "GSliderBackground" min = "0" max = "255" value = 0 oninput="GSliderBackgroundOutput.value=GSliderBackground.value">
									<td>
										<output id = "GSliderBackgroundOutput" name="GSliderBackgroundOutput" for="GSliderBackground">0</output>
									</td>
								</td>
							</tr>
							<tr>
								<td align = "left">
									B:<input type="range" id = "BSliderBackground"name = "BSliderBackground" min = "0" max = "255" value = 0 oninput="BSliderBackgroundOutput.value=BSliderBackground.value">
									<td>
										<output id = "BSliderBackgroundOutput" name="BSliderBackgroundOutput" for="BSliderBackground">0</output>
									</td>
								</td>
							</tr>
							<tr>
								<td colspan = "4" align = "right">
									<input type = "button" id = "HideBoardBackgroundBtn"name = "Hide board background" value =  "Hide board background">	
								</td>
							</tr>			
						</table>
						
					</fieldset>

				</div>
				<div id = "labels/import" style = "width:35%;float:left">

					<div id="labelsDiv" style="width:100%;float:left;">

						<fieldset>
							<legend>Labels</legend>

							<table>
								<tr>
									<td>
										Show
									</td>
									<td align = "left">
										<input type = "checkbox"  id = "labelsShow" name = "labelsShow" checked>
									</td> 

									<td >
										Default
									</td>


								</tr>

								<tr>
									<td>Position:</td>
									<td align = "left">
										<input type="range" id = "positionSLiderLabel"name = "positionSLiderLabel" min = "1" max = "100" value = 60 oninput="pos.value=positionSLiderLabel.value">
										<td>
											<output id = "positionSLiderOutput" name="pos" for="positionSLiderLabel">60</output>
										</td>
									</td>
									<td rowspan = "3" align = "center">
										<input type = "checkBox" id = "defaultLabelOutput" name = "defaultLabelOutput" checked>
									</td>

								</tr>
								<tr>
									<td>Shade:</td>
									<td align = "left">

										<input type="range" id = "shadeSLiderLabel"name = "shadeSLiderLabel" min = "1" max = "100" value = 100 oninput="shade.value=shadeSLiderLabel.value"> 
										<td>
											<output id = "shadeSLiderOutput" name="shade" for="shadeSLiderLabel">100 </output>
										</td>
									</td>

								</tr>
								<tr>
									<td>Size:</td>
									<td align = "left">
										<input type="range" id = "sizeSLiderLabel" name = "sizeSLiderLabel" min = "1" max = "100" value = 75 oninput="sizeing.value=sizeSLiderLabel.value">
										<td>
											<output id = "sizeSLiderOutput" name="sizeing"  for="sizeSLiderLabel">75</output>
										</td>

									</td>
								</tr>

							</table>

						</fieldset>

					</div>

					<div id="Import_Export" style="width:100%;float:left">

						<fieldset>
							<legend>Import/Export Settings</legend>


							<span id = "fileLocation"> no location chosen...</span>

							<br>
							<input type = "button" id = "importSettingsBtn" value = "import settings">

							<input type = "button" id = "exportSettingsBtn" value = "export settings">

						</div>
					</fieldset>
				</div>
				<div id = "logAndBoardAndLaunch" style = "width:20%;float:left">
					<div id="logOutputLocationDiv" style="width:100%;float:left">

						<fieldset>
							<legend>Log Output Location</legend>


							<p id = "logOutputLocationString"> no location chosen...</p>


							<input type = "button" id = "logOutputLocationBtn" value = "choose">
						</fieldset>

					</div>


					<div id="Board" style="width:100%;float:left;">

						<fieldset>
							<legend>Board</legend>

							<span id = "tilt"> Tilt:</span>
							<br>

							<span id = "default"> Default:</span>
							<br>

							<input type = "button" id = "boardTiltBtn"  style = "width:100%"value = "Set Board Tilt">

						</fieldset>

					</div>
					<div id="launch" style="width:100%;float:right;">

						<input type = "button" id = "launchExperimentBtn" value = "launch Experiment">
					</div>
				</div>
				


			</form>
		</div>
	</div>

	<script>
//init canvas
var canvas = $("#PreviewCanvas")[0]
var c=canvas.getContext("2d");

//slider Values	
var prevPosOfPosSlider = $("#positionSLiderLabel").val(),  prevPosOfShadeSlider = $("#shadeSLiderLabel").val();

//Default Values
var labelYPos = 100, labelXPos = 100;
var textColor = "#69C"
var font = $("#sizeSLiderLabel").val() + "px Arial";

var backgroundColor = "rgb(" + $("#RSliderBackground").val() + "," + $("#GSliderBackground").val() + "," + $("#BSliderBackground").val() + ")";

$(document).ready(function(){
	reDrawCanvas();
});

//If you check the default label box
$("#defaultLabelOutput").change(function(){
	if(this.checked){
		changeSize(75);
		changeLum(100);
		changePosition(60);
	}
});
//*****************

//If you check the default background box
$("#defaultBackgroundCheckbox").change(function(){
	if(this.checked){
		backgroundColor = "rgb(0,0,0)";
		reDrawCanvas();
	}
});
//*****************

//if you slide the background sliders
$("#RSliderBackground").change(function(){
	changeBoardBackground();
});
$("#GSliderBackground").change(function(){
	changeBoardBackground();
});
$("#BSliderBackground").change(function(){
	changeBoardBackground();
});
//******************************


//if you slide the label sliders
$("#shadeSLiderLabel").change(function(){
	changeLum($("#shadeSLiderLabel").val());
});

$("#sizeSLiderLabel").change(function(){
	changeSize($("#sizeSLiderLabel").val());
});

$("#positionSLiderLabel").change(function(){
	changePosition($("#positionSLiderLabel").val());
});
//************************

function changeLum(currentPosOfShadeSlider){
	var changePosition = parseInt(currentPosOfShadeSlider) - parseInt(prevPosOfShadeSlider);
	textColor = ColorLuminance(textColor,changePosition/100);
	reDrawCanvas();
	prevPosOfShadeSlider = currentPosOfShadeSlider;
}

function changePosition(currentPosOfSlider){
	var changePosition = parseInt(currentPosOfSlider) - parseInt(prevPosOfPosSlider);
	labelYPos+=(changePosition*-1);
	reDrawCanvas();
	prevPosOfPosSlider = currentPosOfSlider;
}

function changeSize(currentPosOfSizeSlider){	
	
	font= currentPosOfSizeSlider + "px Arial";
	reDrawCanvas();
	
}

//Takes in a color and a % to lumminate From http://www.sitepoint.com/javascript-generate-lighter-darker-color/
function ColorLuminance(hex, lum) {
    // validate hex string
    hex = String(hex).replace(/[^0-9a-f]/gi, '');
    if (hex.length < 6) {
    	hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];
    }
    lum = lum || 0;
    // convert to decimal and change luminosity
    var rgb = "#", c, i;
    for (i = 0; i < 3; i++) {
    	c = parseInt(hex.substr(i*2,2), 16);
    	c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);
    	rgb += ("00"+c).substr(c.length);
    }
    return rgb;
}
//*********************

function drawText(){
	c.textAlign = 'center';
	c.fillStyle = textColor;
	c.font = font;
	c.fillText("Hello World",labelXPos,labelYPos);
}

function drawBackground(){
	c.fillStyle = backgroundColor;
	c.fillRect(0,0,canvas.width,canvas.height);
}

function changeBoardBackground(){
	backgroundColor = "rgb(" + $("#RSliderBackground").val() + "," + $("#GSliderBackground").val() + "," + $("#BSliderBackground").val() + ")";
	reDrawCanvas();
}

function reDrawCanvas(){
	c.clearRect(0,0,canvas.width,canvas.height);
	drawBackground();
	drawText();
}


</script>

</body>
</html>